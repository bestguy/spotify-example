var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,s=(e,s)=>{for(var r in s||(s={}))a.call(s,r)&&l(e,r,s[r]);if(t)for(var r of t(s))n.call(s,r)&&l(e,r,s[r]);return e},r=(e,l)=>{var s={};for(var r in e)a.call(e,r)&&l.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&t)for(var r of t(e))l.indexOf(r)<0&&n.call(e,r)&&(s[r]=e[r]);return s};import{r as o,R as c,a as i}from"./vendor.f103fd95.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const m=o.exports.createContext(void 0),u=e=>{var t=r(e,[]);const a=o.exports.useMemo((()=>`https://accounts.spotify.com/authorize?response_type=token&client_id=${encodeURIComponent("5ba66b08dd254565878aaf78087334cc")}&scope=${encodeURIComponent("user-read-private user-read-currently-playing")}&redirect_uri=${encodeURIComponent("https://bestguy.github.io/spotify-example/")}`),[]);return c.createElement("div",s({className:"d-flex align-items-center justify-content-center h-100"},t),c.createElement("a",{className:"btn btn-primary btn-lg",href:a},"Login to Spotify"))},d=e=>{var t=e,{name:a,className:n=""}=t,l=r(t,["name","className"]);return c.createElement("i",s({className:`bi-${a} ${n}`},l))};function p(){const[e,t]=function(e,t){const a=()=>{try{const a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(a){return console.warn(`Error reading localStorage key “${e}”:`,a),t}},[n,l]=o.exports.useState(a);return o.exports.useEffect((()=>{l(a())}),[]),o.exports.useEffect((()=>{const e=()=>{l(a())};return window.addEventListener("storage",e),window.addEventListener("local-storage",e),()=>{window.removeEventListener("storage",e),window.removeEventListener("local-storage",e)}}),[]),[n,t=>{try{const a=t instanceof Function?t(n):t;window.localStorage.setItem(e,JSON.stringify(a)),l(a),window.dispatchEvent(new Event("local-storage"))}catch(a){console.warn(`Error setting localStorage key “${e}”:`,a)}}]}("playlists",[]);return{playlists:e,addPlaylist:a=>{t([...e,a])},deletePlaylist:a=>{t(e.filter((e=>e.id!==a.id)))},setPlaylists:t,getPlaylistForTrack:function(t){return e.find((e=>{var a;return null==(a=e.songs)?void 0:a.find((e=>e.id===t.id))}))},addTrackToPlaylist:function(a,n){e.find((e=>e.name===n))?t(e.map((e=>{var t;return e.name!==n||(null==(t=e.songs)?void 0:t.find((e=>e.id===a.id)))||(e.songs=e.songs?[...e.songs,a]:[a]),e}))):t([...e,{id:n,name:n,songs:[a]}])}}}const g=e=>{var t=e,{track:a}=t,n=r(t,["track"]);const[l,i]=o.exports.useState(!1),[m,u]=o.exports.useState(),[g,v]=o.exports.useState(),{playlists:f,addTrackToPlaylist:E}=p();function y(e,t){t&&(E(e,t),i(!1),u(void 0),v(void 0))}return c.createElement("div",s({},n),l?"_new"!==g?c.createElement("div",{className:"input-group"},c.createElement("select",{autoFocus:!0,className:"form-select",placeholder:"Pick or Create a Playlist...",value:g,onChange:e=>v(e.target.value)},c.createElement("option",null,"Choose a Playlist…"),f.map((e=>c.createElement("option",{key:e.id,value:e.name},e.name))),c.createElement("option",{value:"_new"},"Create New Playlist…")),c.createElement("button",{className:"btn btn-outline-secondary btn-lg",disabled:!g,onClick:()=>y(a,g)},c.createElement(d,{name:"check-lg"}))):c.createElement("div",{className:"input-group"},c.createElement("input",{autoFocus:!0,className:"form-control",placeholder:"Playlist Name",value:m,onChange:e=>u(e.target.value)}),c.createElement("button",{className:"btn btn-outline-secondary btn-lg",disabled:!m,onClick:()=>y(a,m)},c.createElement(d,{name:"check-lg"}))):c.createElement("button",{className:"btn btn-link btn-lg",onClick:()=>i(!0)},c.createElement(d,{name:g?"heart-fill":"heart",className:"h1"})))},v=e=>{var t=e,{children:a,className:n,track:l}=t,o=r(t,["children","className","track"]);return c.createElement("div",s({className:"d-lg-flex"},o),c.createElement("img",{src:l.album.images[0].url,alt:l.album.name,className:"img-fluid shadow w-50 mb-3"}),c.createElement("div",{className:"text-lg-start ms-lg-4"},c.createElement("h4",null,l.artists[0].name,l.artists.length>1&&" & Others"),c.createElement("h2",null,l.name),c.createElement("h5",{className:"text-muted"},l.album.name),c.createElement(g,{track:l})))};function f(e,t,a=0){const[n,l]=o.exports.useState(void 0),s=async()=>{try{const a=await fetch(e,t);if(204===a.status)l(void 0);else{const e=await a.json();l(e)}}catch(a){console.error(a),l(void 0)}};return o.exports.useEffect((()=>{s()}),[]),o.exports.useEffect((()=>{const e=a?setInterval((()=>s()),a):void 0;return()=>clearInterval(e)}),[a]),n}const E=e=>{var t=r(e,[]);const a=f("https://api.spotify.com/v1/me/player/currently-playing",{headers:{Authorization:`Bearer ${o.exports.useContext(m).access_token}`}},5e3);return c.createElement("div",s({},t),c.createElement("h1",{className:"mb-4"},"Now Playing"),a?c.createElement("div",null,c.createElement(v,{track:a.item})):c.createElement("h2",{className:"text-info fade show"},"No Current Track"))},y=()=>{},h=e=>{var t=e,{onCancel:a=y,onSave:n=y}=t,l=r(t,["onCancel","onSave"]);const[i,m]=o.exports.useState();function u(e){e&&(n({id:(new Date).toISOString(),name:e,songs:[]}),m(void 0))}return c.createElement("form",s({className:"p-2",onSubmit:e=>{u(i),e.preventDefault()}},l),c.createElement("input",{autoFocus:!0,className:"form-control mb-2",value:i,onChange:e=>m(e.target.value)}),c.createElement("div",{className:"btn-group w-100"},c.createElement("button",{className:"btn btn-primary",disabled:!(null==i?void 0:i.trim().length),onClick:()=>u(i)},c.createElement(d,{name:"check",className:"me-2"})," Save"),c.createElement("button",{className:"btn btn-secondary",onClick:()=>a()},c.createElement(d,{name:"x",className:"me-2"})," Cancel")))},b=()=>{},N=e=>{var t=e,{active:a,onPlaylist:n=b}=t,l=r(t,["active","onPlaylist"]);const[i,m]=o.exports.useState(!1),{playlists:u,addPlaylist:g,deletePlaylist:v}=p();return c.createElement("div",s({className:"list-group list-group-flush"},l),c.createElement("button",{className:"list-group-item list-group-item-action d-flex "+(a?"":"active"),onClick:()=>n(void 0)},c.createElement(d,{name:"music-player",className:"me-2 "+(a?"text-muted":"")})," Now Playing"),u.map((e=>{var t,l;return c.createElement("a",{key:e.id,className:"list-group-item list-group-item-action d-flex "+(a===e?"active":""),onClick:()=>n(e)},c.createElement(d,{name:"collection-play-fill",className:"me-2 "+(a!==e?"text-muted":"")}),e.name,c.createElement("span",{className:"ms-auto"},(null==(t=e.songs)?void 0:t.length)?c.createElement("span",{className:"badge bg-primary"},null==(l=e.songs)?void 0:l.length):void 0,c.createElement("button",{className:"btn btn-link p-0",onClick:t=>{v(e),t.preventDefault()}},c.createElement(d,{name:"x",className:"me-2 "+(a!==e?"text-muted":"")}))))})),!i&&c.createElement("button",{className:"list-group-item list-group-item-action",onClick:()=>m(!0)},c.createElement(d,{name:"plus-circle",className:"me-2 text-muted"}),"Add Playlist"),i&&c.createElement(h,{onCancel:()=>m(!1),onSave:e=>{g(e),m(!1)}}))};const x=e=>{var t,a,n=e,{playlistId:l}=n,i=r(n,["playlistId"]);const{playlist:m,removeTrack:u}=function(e){const[t,a]=o.exports.useState(),{playlists:n,setPlaylists:l}=p();return o.exports.useEffect((()=>{a(n.find((t=>t.id===e)))}),[e,n]),{playlist:t,addTrack:t=>{l(n.map((a=>{var n;return a.id!==e||(null==(n=a.songs)?void 0:n.find((e=>e.id===t.id)))||(a.songs=a.songs?[...a.songs,t]:[t]),a})))},removeTrack:t=>{l(n.map((a=>{var n;return a.id===e&&(a.songs=(null==(n=a.songs)?void 0:n.filter((e=>e.id!==t.id)))||[]),a})))}}}(l);return c.createElement("div",s({},i),c.createElement("h4",{className:"text-muted"},"Playlist"),m&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"mb-4"},m.name),(null==(t=m.songs)?void 0:t.length)?c.createElement("ul",{className:"list-group"},null==(a=m.songs)?void 0:a.map((e=>c.createElement("li",{className:"list-group-item d-flex align-items-center"},c.createElement("img",{src:e.album.images[0].url,alt:e.album.name,className:"shadow-sm me-3",width:70,height:70}),c.createElement("div",{className:"text-start"},c.createElement("h6",null,e.artists[0].name,e.artists.length>1&&" & Others"),c.createElement("h5",null,e.name),c.createElement("h6",{className:"text-muted"},e.album.name)),c.createElement("button",{className:"btn btn-link ms-auto",onClick:()=>u(e)},c.createElement(d,{name:"x-lg",className:"text-muted"})))))):c.createElement("h2",{className:"text-info fade show"},"No Songs in Playlist")))};const w=e=>{var t=r(e,[]);const a=f("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${o.exports.useContext(m).access_token}`}});return c.createElement("div",s({className:"p-3 text-center"},t),(null==a?void 0:a.images.length)?c.createElement("img",{alt:null==a?void 0:a.display_name,src:null==a?void 0:a.images[0].url,className:"rounded-circle w-75 d-none d-sm-inline-block"}):void 0,c.createElement("div",{className:"d-flex d-sm-block"},c.createElement("h3",{className:"text-lowercase"},null==a?void 0:a.display_name),c.createElement("a",{className:"btn btn-link btn-sm ms-auto",href:"#"},"Logout")))};const k=e=>{var t=r(e,[]);const[a,n]=o.exports.useState();return c.createElement("div",s({id:"content",className:"d-flex d-sm-grid flex-column flex-sm-row"},t),c.createElement("aside",{id:"playlists",className:"bg-dark"},c.createElement(w,null),c.createElement(N,{active:a,onPlaylist:e=>n(e)})),c.createElement("div",s({className:"container text-center text-lg-start p-5"},t),a?c.createElement(x,{playlistId:a.id}):c.createElement(E,null)))};function C(){const e=function(){const[e,t]=o.exports.useState((()=>window.location.hash)),a=o.exports.useCallback((()=>{t(window.location.hash)}),[]);return o.exports.useEffect((()=>(window.addEventListener("hashchange",a),()=>window.removeEventListener("hashchange",a)))),e}();return e?function(e){const t={};return e.substr(1).split("&").forEach((e=>{const[a,n]=e.split("=");t[a]=decodeURIComponent(n)})),t}(e):void 0}const S=()=>{const e=C();return c.createElement(m.Provider,{value:e},c.createElement("div",{id:"main"},e?c.createElement(k,null):c.createElement(u,null)))};i.render(c.createElement(c.StrictMode,null,c.createElement(S,null)),document.getElementById("root"));
